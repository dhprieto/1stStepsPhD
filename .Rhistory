orinaFlavNum_0_clusters$Sexo <- rescale(as.numeric(orinaFlavNum_0_clusters$Sexo))
orinaFlavNum_F_clusters$Endulzante <- rescale(as.numeric(orinaFlavNum_F_clusters$Endulzante))
orinaFlavNum_F_clusters$Sexo <- rescale(as.numeric(orinaFlavNum_F_clusters$Sexo))
longtableT_0 <-melt(orinaFlavNum_0_clusters[,colnames(orinaFlavNum_0_clusters)!="numVol"], id = "clusters")
longtableT_F <-melt(orinaFlavNum_F_clusters[,colnames(orinaFlavNum_0_clusters)!="numVol"], id = "clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina Flavonoids T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_F, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteF, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina Flavonoids T F")+
labs(y = "standarized value", x = "variables/clusters")
orinaAnt <- preprocessTablas("data/", "tablaOrinaAnt.csv")
orinaAntFactors <- orinaAnt$tablaFactors
orinaAntNum <- orinaAnt$tablaNum
orinaAntT_0 <- orinaAnt$tabla_Tiempo0
orinaAntT_F <- orinaAnt$tabla_TiempoF
model_clustering_OA <- Mclust(orinaAnt$tablaNum)
p1 <- fviz_mclust(object = model_clustering_OA, what = "BIC", pallete = "jco",
title = "Model Selection Orina ant") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_OA, what = "classification", geom = "point",
title = "Clusters Plot Orina ant", pallete = "jco")
ggarrange(p1,p2)
orinaAnt_clusters <- cbind(orinaAnt$tablaNum, clusters = as.factor(model_clustering_OA$classification),
Endulzante = orinaAntFactors$Endulzante,
Sexo = orinaAntFactors$Sexo,
Tiempo = orinaAntFactors$Tiempo)
tableSexoOA <- table(orinaAnt_clusters$Sexo,orinaAnt_clusters$clusters)
tableEdulcoranteOA <- table(orinaAnt_clusters$Endulzante,orinaAnt_clusters$clusters)
orinaAnt_clusters$Endulzante <- rescale(as.numeric(orinaAnt_clusters$Endulzante))
orinaAnt_clusters$Sexo <- rescale(as.numeric(orinaAnt_clusters$Sexo))
orinaAnt_clusters$Tiempo <- rescale(as.numeric(orinaAnt_clusters$Tiempo))
longtableOA <- melt(orinaAnt_clusters, id = c("clusters", "Tiempo"))
ggplot(longtableOA, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoOA, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteOA, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableOA, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoOA, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteOA, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antocians")+
labs(y = "standarized value", x = "variables/clusters")
orinaAnt_Factors_T0 <- subset(orinaAntFactors, Tiempo == "0")
orinaAnt_Factors_TF <- subset(orinaAntFactors, Tiempo == "Final")
model_clustering_OFT_0 <- Mclust(orinaAntT_0[, colnames(orinaAntT_0) != "numVol"])
model_clustering_OFT_F <- Mclust(orinaAntT_F[, colnames(orinaAntT_F) != "numVol"])
p1 <- fviz_mclust(object = model_clustering_OFT_0, what = "BIC", pallete = "jco",
title = "Model Selection Orina Ant T 0") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_OFT_0, what = "classification", geom = "point",
title = "Clusters Plot Orina Ant T 0", pallete = "jco")
p3 <- fviz_mclust(object = model_clustering_OFT_F, what = "BIC", pallete = "jco",
title = "Model Selection Orina Ant T F") + scale_x_discrete(limits = c(1:10))
p4 <- fviz_mclust(model_clustering_OFT_F, what = "classification", geom = "point",
title = "Clusters Plot Orina Ant T F", pallete = "jco")
ggarrange(p1,p3)
ggarrange(p2,p4)
orinaAntNum_0_clusters <- cbind(orinaAntT_0, clusters = as.factor(model_clustering_OFT_0$classification),
Endulzante = orinaAnt_Factors_T0$Endulzante,
Sexo = orinaAnt_Factors_T0$Sexo)
orinaAntNum_F_clusters <- cbind(orinaAntT_F, clusters = as.factor(model_clustering_OFT_F$classification),
Endulzante = orinaAnt_Factors_TF$Endulzante,
Sexo = orinaAnt_Factors_TF$Sexo)
tableSexo0 <- table(orinaAntNum_0_clusters$Sexo,orinaAntNum_0_clusters$clusters)
tableEdulcorante0 <- table(orinaAntNum_0_clusters$Endulzante,orinaAntNum_0_clusters$clusters)
tableSexoF <- table(orinaAntNum_F_clusters$Sexo,orinaAntNum_F_clusters$clusters)
tableEdulcoranteF <- table(orinaAntNum_F_clusters$Endulzante,orinaAntNum_F_clusters$clusters)
orinaAntNum_0_clusters$Endulzante <- rescale(as.numeric(orinaAntNum_0_clusters$Endulzante))
orinaAntNum_0_clusters$Sexo <- rescale(as.numeric(orinaAntNum_0_clusters$Sexo))
orinaAntNum_F_clusters$Endulzante <- rescale(as.numeric(orinaAntNum_F_clusters$Endulzante))
orinaAntNum_F_clusters$Sexo <- rescale(as.numeric(orinaAntNum_F_clusters$Sexo))
longtableT_0 <-melt(orinaAntNum_0_clusters[,colnames(orinaAntNum_0_clusters)!="numVol"], id = "clusters")
longtableT_F <-melt(orinaAntNum_F_clusters[,colnames(orinaAntNum_0_clusters)!="numVol"], id = "clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina Antocians T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_F, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteF, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina Antocians T F")+
labs(y = "standarized value", x = "variables/clusters")
plasmaAnt <- preprocessTablas("data/", "tablaplasmaAnt.csv")
plasmaAntFactors <- plasmaAnt$tablaFactors
plasmaAntNum <- plasmaAnt$tablaNum
plasmaAntT_0 <- plasmaAnt$tabla_Tiempo0
plasmaAntT_F <- plasmaAnt$tabla_TiempoF
pcaVarios(plasmaAntFactors, "Plasma Antocianos")
checkCluster(plasmaAntT_0[, colnames(plasmaAntT_0) != "numVol"])
checkCluster(plasmaAntT_F[, colnames(plasmaAntT_F) != "numVol"])
clusterVarios()
model_clustering_PA <- Mclust(plasmaAnt$tablaNum)
p1 <- fviz_mclust(object = model_clustering_PA, what = "BIC", pallete = "jco",
title = "Model Selection plasma ant") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_PA, what = "classification", geom = "point",
title = "Clusters Plot plasma ant", pallete = "jco")
ggarrange(p1,p2)
plasmaAnt_clusters <- cbind(plasmaAnt$tablaNum, clusters = as.factor(model_clustering_PA$classification),
Endulzante = plasmaAntFactors$Endulzante,
Sexo = plasmaAntFactors$Sexo,
Tiempo = plasmaAntFactors$Tiempo)
tableSexoPA <- table(plasmaAnt_clusters$Sexo,plasmaAnt_clusters$clusters)
tableEdulcorantePA <- table(plasmaAnt_clusters$Endulzante,plasmaAnt_clusters$clusters)
plasmaAnt_clusters$Endulzante <- rescale(as.numeric(plasmaAnt_clusters$Endulzante))
plasmaAnt_clusters$Sexo <- rescale(as.numeric(plasmaAnt_clusters$Sexo))
plasmaAnt_clusters$Tiempo <- rescale(as.numeric(plasmaAnt_clusters$Tiempo))
longtablePA <- melt(plasmaAnt_clusters, id = c("clusters", "Tiempo"))
ggplot(longtablePA, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPA, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePA, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis plasma antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePA, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPA, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePA, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis plasma antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePA, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPA, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePA, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis plasma ant")+
labs(y = "standarized value", x = "variables/clusters")
plasmaAnt_Factors_T0 <- subset(plasmaAntFactors, Tiempo == "0")
plasmaAnt_Factors_TF <- subset(plasmaAntFactors, Tiempo == "Final")
model_clustering_OFT_0 <- Mclust(plasmaAntT_0[, colnames(plasmaAntT_0) != "numVol"])
model_clustering_OFT_F <- Mclust(plasmaAntT_F[, colnames(plasmaAntT_F) != "numVol"])
p1 <- fviz_mclust(object = model_clustering_OFT_0, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Ant T 0") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_OFT_0, what = "classification", geom = "point",
title = "Clusters Plot Plasma Ant T 0", pallete = "jco")
p3 <- fviz_mclust(object = model_clustering_OFT_F, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Ant T F") + scale_x_discrete(limits = c(1:10))
p4 <- fviz_mclust(model_clustering_OFT_F, what = "classification", geom = "point",
title = "Clusters Plot Plasma Ant T F", pallete = "jco")
ggarrange(p1,p3)
ggarrange(p2,p4)
plasmaAntNum_0_clusters <- cbind(plasmaAntT_0, clusters = as.factor(model_clustering_OFT_0$classification),
Endulzante = plasmaAnt_Factors_T0$Endulzante,
Sexo = plasmaAnt_Factors_T0$Sexo)
plasmaAntNum_F_clusters <- cbind(plasmaAntT_F, clusters = as.factor(model_clustering_OFT_F$classification),
Endulzante = plasmaAnt_Factors_TF$Endulzante,
Sexo = plasmaAnt_Factors_TF$Sexo)
tableSexo0 <- table(plasmaAntNum_0_clusters$Sexo,plasmaAntNum_0_clusters$clusters)
tableEdulcorante0 <- table(plasmaAntNum_0_clusters$Endulzante,plasmaAntNum_0_clusters$clusters)
tableSexoF <- table(plasmaAntNum_F_clusters$Sexo,plasmaAntNum_F_clusters$clusters)
tableEdulcoranteF <- table(plasmaAntNum_F_clusters$Endulzante,plasmaAntNum_F_clusters$clusters)
plasmaAntNum_0_clusters$Endulzante <- rescale(as.numeric(plasmaAntNum_0_clusters$Endulzante))
plasmaAntNum_0_clusters$Sexo <- rescale(as.numeric(plasmaAntNum_0_clusters$Sexo))
plasmaAntNum_F_clusters$Endulzante <- rescale(as.numeric(plasmaAntNum_F_clusters$Endulzante))
plasmaAntNum_F_clusters$Sexo <- rescale(as.numeric(plasmaAntNum_F_clusters$Sexo))
longtableT_0 <-melt(plasmaAntNum_0_clusters[,colnames(plasmaAntNum_0_clusters)!="numVol"], id = "clusters")
longtableT_F <-melt(plasmaAntNum_F_clusters[,colnames(plasmaAntNum_0_clusters)!="numVol"], id = "clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Antocians T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Ant T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_F, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteF, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Ant T F")+
labs(y = "standarized value", x = "variables/clusters")
plasmaFlav <- preprocessTablas("data/", "tablaplasmaFlav.csv")
plasmaFlavFactors <- plasmaFlav$tablaFactors
plasmaFlavNum <- plasmaFlav$tablaNum
plasmaFlavT_0 <- plasmaFlav$tabla_Tiempo0
plasmaFlavT_F <- plasmaFlav$tabla_TiempoF
model_clustering_PF <- Mclust(plasmaFlav$tablaNum)
p1 <- fviz_mclust(object = model_clustering_PF, what = "BIC", pallete = "jco",
title = "Model Selection Orina ant") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_PF, what = "classification", geom = "point",
title = "Clusters Plot Orina ant", pallete = "jco")
ggarrange(p1,p2)
plasmaFlav_clusters <- cbind(plasmaFlav$tablaNum, clusters = as.factor(model_clustering_PF$classification),
Endulzante = plasmaFlavFactors$Endulzante,
Sexo = plasmaFlavFactors$Sexo,
Tiempo = plasmaFlavFactors$Tiempo)
tableSexoPF <- table(plasmaFlav_clusters$Sexo,plasmaFlav_clusters$clusters)
tableEdulcorantePF <- table(plasmaFlav_clusters$Endulzante,plasmaFlav_clusters$clusters)
plasmaFlav_clusters$Endulzante <- rescale(as.numeric(plasmaFlav_clusters$Endulzante))
plasmaFlav_clusters$Sexo <- rescale(as.numeric(plasmaFlav_clusters$Sexo))
plasmaFlav_clusters$Tiempo <- rescale(as.numeric(plasmaFlav_clusters$Tiempo))
longtablePF <- melt(plasmaFlav_clusters, id = c("clusters", "Tiempo"))
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
p1 <- fviz_mclust(object = model_clustering_PF, what = "BIC", pallete = "jco",
title = "Model Selection Plasma flav") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_PF, what = "classification", geom = "point",
title = "Clusters Plot Plasma flav", pallete = "jco")
ggarrange(p1,p2)
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma flav")+
labs(y = "standarized value", x = "variables/clusters")
plasmaFlav_Factors_T0 <- subset(plasmaFlavFactors, Tiempo == "0")
plasmaFlav_Factors_TF <- subset(plasmaFlavFactors, Tiempo == "Final")
model_clustering_OFT_0 <- Mclust(plasmaFlavT_0[, colnames(plasmaFlavT_0) != "numVol"])
model_clustering_OFT_F <- Mclust(plasmaFlavT_F[, colnames(plasmaFlavT_F) != "numVol"])
p1 <- fviz_mclust(object = model_clustering_OFT_0, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Flav T 0") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_OFT_0, what = "classification", geom = "point",
title = "Clusters Plot Plasma Flav T 0", pallete = "jco")
p3 <- fviz_mclust(object = model_clustering_OFT_F, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Flav T F") + scale_x_discrete(limits = c(1:10))
p4 <- fviz_mclust(model_clustering_OFT_F, what = "classification", geom = "point",
title = "Clusters Plot Plasma Flav T F", pallete = "jco")
ggarrange(p1,p3)
ggarrange(p2,p4)
plasmaFlavNum_0_clusters <- cbind(plasmaFlavT_0, clusters = as.factor(model_clustering_OFT_0$classification),
Endulzante = plasmaFlav_Factors_T0$Endulzante,
Sexo = plasmaFlav_Factors_T0$Sexo)
plasmaFlavNum_F_clusters <- cbind(plasmaFlavT_F, clusters = as.factor(model_clustering_OFT_F$classification),
Endulzante = plasmaFlav_Factors_TF$Endulzante,
Sexo = plasmaFlav_Factors_TF$Sexo)
tableSexo0 <- table(plasmaFlavNum_0_clusters$Sexo,plasmaFlavNum_0_clusters$clusters)
tableEdulcorante0 <- table(plasmaFlavNum_0_clusters$Endulzante,plasmaFlavNum_0_clusters$clusters)
tableSexoF <- table(plasmaFlavNum_F_clusters$Sexo,plasmaFlavNum_F_clusters$clusters)
tableEdulcoranteF <- table(plasmaFlavNum_F_clusters$Endulzante,plasmaFlavNum_F_clusters$clusters)
plasmaFlavNum_0_clusters$Endulzante <- rescale(as.numeric(plasmaFlavNum_0_clusters$Endulzante))
plasmaFlavNum_0_clusters$Sexo <- rescale(as.numeric(plasmaFlavNum_0_clusters$Sexo))
plasmaFlavNum_F_clusters$Endulzante <- rescale(as.numeric(plasmaFlavNum_F_clusters$Endulzante))
plasmaFlavNum_F_clusters$Sexo <- rescale(as.numeric(plasmaFlavNum_F_clusters$Sexo))
longtableT_0 <-melt(plasmaFlavNum_0_clusters[,colnames(plasmaFlavNum_0_clusters)!="numVol"], id = "clusters")
longtableT_F <-melt(plasmaFlavNum_F_clusters[,colnames(plasmaFlavNum_0_clusters)!="numVol"], id = "clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Flavonoids T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 8, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Flavonoids T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_F, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 9, y = 1.03, label = "Mujer") +
annotate("text",x = 9, y = -0.03, label = "Hombre") +
annotate("text", x = 9, y = 1.03, label = "SU") +
annotate("text",x = 8, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteF, theme = ttheme_default(base_size = 8)), xmin= 9,xmax=11, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Flavonoids T F")+
labs(y = "standarized value", x = "variables/clusters")
plasmaFlav_adjusted <- preprocessTablas("data/", "tablaplasmaFlav_adjusted.csv")
plasmaFlav_adjustedFactors <- plasmaFlav_adjusted$tablaFactors
plasmaFlav_adjustedNum <- plasmaFlav_adjusted$tablaNum
plasmaFlav_adjustedT_0 <- plasmaFlav_adjusted$tabla_Tiempo0
plasmaFlav_adjustedT_F <- plasmaFlav_adjusted$tabla_TiempoF
model_clustering_PF <- Mclust(plasmaFlav_adjusted$tablaNum)
p1 <- fviz_mclust(object = model_clustering_PF, what = "BIC", pallete = "jco",
title = "Model Selection Orina ant") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_PF, what = "classification", geom = "point",
title = "Clusters Plot Orina ant", pallete = "jco")
ggarrange(p1,p2)
p1 <- fviz_mclust(object = model_clustering_PF, what = "BIC", pallete = "jco",
title = "Model Selection Plasma ADJ flav") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_PF, what = "classification", geom = "point",
title = "Clusters Plot Plasma ADJ flav", pallete = "jco")
ggarrange(p1,p2)
plasmaFlav_adjusted_clusters <- cbind(plasmaFlav_adjusted$tablaNum, clusters = as.factor(model_clustering_PF$classification),
Endulzante = plasmaFlav_adjustedFactors$Endulzante,
Sexo = plasmaFlav_adjustedFactors$Sexo,
Tiempo = plasmaFlav_adjustedFactors$Tiempo)
tableSexoPF <- table(plasmaFlav_adjusted_clusters$Sexo,plasmaFlav_adjusted_clusters$clusters)
tableEdulcorantePF <- table(plasmaFlav_adjusted_clusters$Endulzante,plasmaFlav_adjusted_clusters$clusters)
plasmaFlav_adjusted_clusters$Endulzante <- rescale(as.numeric(plasmaFlav_adjusted_clusters$Endulzante))
plasmaFlav_adjusted_clusters$Sexo <- rescale(as.numeric(plasmaFlav_adjusted_clusters$Sexo))
plasmaFlav_adjusted_clusters$Tiempo <- rescale(as.numeric(plasmaFlav_adjusted_clusters$Tiempo))
longtablePF <- melt(plasmaFlav_adjusted_clusters, id = c("clusters", "Tiempo"))
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 14, y = 1.03, label = "Mujer") +
annotate("text",x = 14, y = -0.03, label = "Hombre") +
annotate("text", x = 13, y = 1.03, label = "SU") +
annotate("text",x = 13, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 13,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Orina antonoids")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtablePF, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
facet_wrap(~Tiempo)+
annotate("text", x = 11, y = 1.03, label = "Mujer") +
annotate("text",x = 11, y = -0.03, label = "Hombre") +
annotate("text", x = 10, y = 1.03, label = "SU") +
annotate("text",x = 10, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoPF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorantePF, theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma ADJ flav")+
labs(y = "standarized value", x = "variables/clusters")
plasmaFlav_adjusted_Factors_T0 <- subset(plasmaFlav_adjustedFactors, Tiempo == "0")
plasmaFlav_adjusted_Factors_TF <- subset(plasmaFlav_adjustedFactors, Tiempo == "Final")
model_clustering_OFT_0 <- Mclust(plasmaFlav_adjustedT_0[, colnames(plasmaFlav_adjustedT_0) != "numVol"])
model_clustering_OFT_F <- Mclust(plasmaFlav_adjustedT_F[, colnames(plasmaFlav_adjustedT_F) != "numVol"])
p1 <- fviz_mclust(object = model_clustering_OFT_0, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Flav T 0") + scale_x_discrete(limits = c(1:10))
p2 <- fviz_mclust(model_clustering_OFT_0, what = "classification", geom = "point",
title = "Clusters Plot Plasma Flav T 0", pallete = "jco")
p3 <- fviz_mclust(object = model_clustering_OFT_F, what = "BIC", pallete = "jco",
title = "Model Selection Plasma Flav T F") + scale_x_discrete(limits = c(1:10))
p4 <- fviz_mclust(model_clustering_OFT_F, what = "classification", geom = "point",
title = "Clusters Plot Plasma Flav T F", pallete = "jco")
ggarrange(p1,p3)
ggarrange(p2,p4)
p2 <- fviz_mclust(model_clustering_OFT_0, what = "classification", geom = "point",
title = "Clusters Plot Plasma ADJ Flav T 0", pallete = "jco")
p4 <- fviz_mclust(model_clustering_OFT_F, what = "classification", geom = "point",
title = "Clusters Plot Plasma ADJ Flav T F", pallete = "jco")
ggarrange(p2,p4)
plasmaFlav_adjustedNum_0_clusters <- cbind(plasmaFlav_adjustedT_0, clusters = as.factor(model_clustering_OFT_0$classification),
Endulzante = plasmaFlav_adjusted_Factors_T0$Endulzante,
Sexo = plasmaFlav_adjusted_Factors_T0$Sexo)
plasmaFlav_adjustedNum_F_clusters <- cbind(plasmaFlav_adjustedT_F, clusters = as.factor(model_clustering_OFT_F$classification),
Endulzante = plasmaFlav_adjusted_Factors_TF$Endulzante,
Sexo = plasmaFlav_adjusted_Factors_TF$Sexo)
tableSexo0 <- table(plasmaFlav_adjustedNum_0_clusters$Sexo,plasmaFlav_adjustedNum_0_clusters$clusters)
tableEdulcorante0 <- table(plasmaFlav_adjustedNum_0_clusters$Endulzante,plasmaFlav_adjustedNum_0_clusters$clusters)
tableSexoF <- table(plasmaFlav_adjustedNum_F_clusters$Sexo,plasmaFlav_adjustedNum_F_clusters$clusters)
tableEdulcoranteF <- table(plasmaFlav_adjustedNum_F_clusters$Endulzante,plasmaFlav_adjustedNum_F_clusters$clusters)
plasmaFlav_adjustedNum_0_clusters$Endulzante <- rescale(as.numeric(plasmaFlav_adjustedNum_0_clusters$Endulzante))
plasmaFlav_adjustedNum_0_clusters$Sexo <- rescale(as.numeric(plasmaFlav_adjustedNum_0_clusters$Sexo))
plasmaFlav_adjustedNum_F_clusters$Endulzante <- rescale(as.numeric(plasmaFlav_adjustedNum_F_clusters$Endulzante))
plasmaFlav_adjustedNum_F_clusters$Sexo <- rescale(as.numeric(plasmaFlav_adjustedNum_F_clusters$Sexo))
longtableT_0 <-melt(plasmaFlav_adjustedNum_0_clusters[,colnames(plasmaFlav_adjustedNum_0_clusters)!="numVol"], id = "clusters")
longtableT_F <-melt(plasmaFlav_adjustedNum_F_clusters[,colnames(plasmaFlav_adjustedNum_0_clusters)!="numVol"], id = "clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 15, y = 1.03, label = "Mujer") +
annotate("text",x = 15, y = -0.03, label = "Hombre") +
annotate("text", x = 14, y = 1.03, label = "SU") +
annotate("text",x = 14, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 15,xmax=17, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma Flavonoids T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_0, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 11, y = 1.03, label = "Mujer") +
annotate("text",x = 11, y = -0.03, label = "Hombre") +
annotate("text", x = 10, y = 1.03, label = "SU") +
annotate("text",x = 10, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexo0, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcorante0, theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma ADJ Flavonoids T 0")+
labs(y = "standarized value", x = "variables/clusters")
ggplot(longtableT_F, aes(variable,as.numeric(value), fill=factor(clusters))) +
geom_boxplot()+
annotate("text", x = 11, y = 1.03, label = "Mujer") +
annotate("text",x = 11, y = -0.03, label = "Hombre") +
annotate("text", x = 10, y = 1.03, label = "SU") +
annotate("text",x = 10, y = -0.03, label = "SA")+
annotation_custom(grob = tableGrob(tableSexoF, rows = c("H", "M"), theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableEdulcoranteF, theme = ttheme_default(base_size = 8)), xmin= 11,xmax=13, ymin=0, ymax=0.25)+
ggtitle("Boxplot Cluster Analysis Plasma ADJ Flavonoids T F")+
labs(y = "standarized value", x = "variables/clusters")

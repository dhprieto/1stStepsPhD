nombreTabla)))
print(fviz_contrib(pca_0xM, choice="var", axes = 2, title = paste("ContribVar dim2 Tiempo 0 Sexo M",
nombreTabla)))
# PCA TiempoxEndulzante
# PCA SexoxEndulzante
tabla_MxSAx0 <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="SA" & Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_MxSAxF <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="SA" & Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSAx0 <- subset(tabla, Sexo == "MUJER" & Endulzante =="SA"& Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSAxF <- subset(tabla, Sexo == "MUJER" & Endulzante =="SA"& Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_MxSTx0 <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="ST" & Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_MxSTxF <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="ST"& Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSTx0 <- subset(tabla, Sexo == "MUJER" & Endulzante =="ST" & Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSTxF <- subset(tabla, Sexo == "MUJER" & Endulzante =="ST" & Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_MxSUx0 <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="SU" & Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_MxSUxF <- subset(tabla, Sexo == "HOMBRE" & Endulzante =="SU" & Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSUx0 <- subset(tabla, Sexo == "MUJER" & Endulzante =="SU" & Tiempo == "0",
select =-c(Tiempo, Sexo, Endulzante, numVol))
tabla_FxSUxF <- subset(tabla, Sexo == "MUJER" & Endulzante =="SU" & Tiempo == "Final",
select =-c(Tiempo, Sexo, Endulzante, numVol))
pca_MxSAx0 <- PCA(tabla_MxSAx0, scale.unit=F)
print(fviz_contrib(pca_MxSAx0, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante SA Tiempo 0",
nombreTabla)))
print(fviz_contrib(pca_MxSAx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante SA Tiempo 0",
nombreTabla)))
pca_MxSAxF <- PCA(tabla_MxSAxF, scale.unit=F)
print(fviz_contrib(pca_MxSAxF, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante SA Tiempo F",
nombreTabla)))
print(fviz_contrib(pca_MxSAxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante SA Tiempo F",
nombreTabla)))
pca_FxSAx0 <- PCA(tabla_FxSAx0, scale.unit=F)
print(fviz_contrib(pca_FxSAx0, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante SA Tiempo 0",
nombreTabla)))
print(fviz_contrib(pca_FxSAx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante SA Tiempo 0",
nombreTabla)))
pca_FxSAxF <- PCA(tabla_FxSAxF, scale.unit=F)
print(fviz_contrib(pca_FxSAxF, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante SA Tiempo F",
nombreTabla)))
print(fviz_contrib(pca_FxSAxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante SA Tiempo F",
nombreTabla)))
pca_MxSTx0 <- PCA(tabla_MxSTx0, scale.unit=F)
print(fviz_contrib(pca_MxSTx0, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante ST Tiempo 0",
nombreTabla)))
print(fviz_contrib(pca_MxSTx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante ST Tiempo 0",
nombreTabla)))
pca_MxSTxF <- PCA(tabla_MxSTxF, scale.unit=F)
print(fviz_contrib(pca_MxSTxF, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante ST Tiempo F",
nombreTabla)))
print(fviz_contrib(pca_MxSTxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante ST Tiempo F",
nombreTabla)))
pca_FxSTx0 <- PCA(tabla_FxSTx0, scale.unit=F)
print(fviz_contrib(pca_FxSTx0, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante ST Tiempo 0", nombreTabla)))
print(fviz_contrib(pca_FxSTx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante ST Tiempo 0",
nombreTabla)))
pca_FxSTxF <- PCA(tabla_FxSTxF, scale.unit=F)
print(fviz_contrib(pca_FxSTxF, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante ST Tiempo F", nombreTabla)))
print(fviz_contrib(pca_FxSTxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante ST Tiempo F",
nombreTabla)))
pca_MxSUx0 <- PCA(tabla_MxSUx0, scale.unit=F)
print(fviz_contrib(pca_MxSUx0, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante SU Tiempo 0",
nombreTabla)))
print(fviz_contrib(pca_MxSUx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante SU Tiempo 0",
nombreTabla)))
pca_MxSUxF <- PCA(tabla_MxSUxF, scale.unit=F)
print(fviz_contrib(pca_MxSUxF, choice="var", title = paste("ContribVar dim1 Sexo M Endulzante SU Tiempo F",
nombreTabla)))
print(fviz_contrib(pca_MxSUxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo M Endulzante SU Tiempo F",
nombreTabla)))
pca_FxSUx0 <- PCA(tabla_FxSUx0, scale.unit=F)
print(fviz_contrib(pca_FxSUx0, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante SU Tiempo 0",
nombreTabla)))
print(fviz_contrib(pca_FxSUx0, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante SU Tiempo 0",
nombreTabla)))
pca_FxSUxF <- PCA(tabla_FxSUxF, scale.unit=F)
print(fviz_contrib(pca_FxSUxF, choice="var", title = paste("ContribVar dim1 Sexo F Endulzante SU Tiempo F",
nombreTabla)))
print(fviz_contrib(pca_FxSUxF, choice="var", axes = 2, title = paste("ContribVar dim2 Sexo F Endulzante SU Tiempo F",
nombreTabla)))
}
clusterVarios <- function (tabla, nclust) {
nombreTabla <- deparse(quote(tabla))
### Aplicamos clustering
# K-means clustering
set.seed(123)
km_datos_A <- kmeans(x = tabla, centers = nclust)
p1 <- fviz_cluster(object = km_datos_A, data = tabla,
ellipse.type = "norm", geom = "point", main = paste("Resultados clustering kmeans ",
nombreTabla),
stand = FALSE, palette = "jco", show.legend = T)
# PAM clustering
pam_clusters <- pam(x = tabla, k = nclust, metric = "manhattan")
p2 <- fviz_cluster(object = pam_clusters, data = tabla, ellipse.type = "t",
repel = TRUE) +
theme_bw() +
labs(title = "Resultados clustering PAM") +
theme(legend.position = "none")
# fuzzy clustering
fuzzy_cluster <- fanny(x = tabla, k = nclust, diss = FALSE, metric = "manhattan", stand = FALSE)
p3 <- fviz_cluster(object = fuzzy_cluster, repel = TRUE, ellipse.type = "norm",
pallete = "jco") + theme_bw() + labs(title = "Fuzzy Cluster plot")
# Hierarchical clustering
p4 <- fviz_dend(x = hclust(get_dist(tabla, method = "manhattan")), k = nclust, k_colors = "jco",
show_labels = T, main = paste("Datos ", nombreTabla))
model_clustering <- Mclust(tabla)
p5 <- fviz_mclust(object = model_clustering, what = "BIC", pallete = "jco") +
scale_x_discrete(limits = c(1:10))
p6 <- fviz_mclust(model_clustering, what = "classification", geom = "point",
pallete = "jco")
print(p1)
print(p2)
print(p3)
print(p4)
print(p5)
print(p6)
return(model_clustering)
}
set.seed(123)
datos <- orinaFlavDupl
datos %>% sample_n_by(EG, Peso, size = 1)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
get_summary_stats(score, type="meand_sd")
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
get_summary_stats(score, type="mean_sd")
datos %>%
group_by(Endulzante, Sexo, Tiempo)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
get_summary_stats(EG, type="mean_sd")
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE
)
bxp
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = TRUE
)
bxp
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
ggqqplot(datos, "EG", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
get_anova_table(res.aov)
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos$EG
all(is.na(atos$EG))
all(is.na(datos$EG))
all(is.na(datos$EG))
all(is.na(datos$Tiempo))
all(is.na(datos$Sexo))
all(is.na(datos$Endulzante))
anova_pareado_EG <- aov(formula = EG ~ Sexo * Endulzante * Tiempo +
Error(numVol/Tiempo),
data = orinaFlavDupl)
all(is.na(datos$numVol))
bxp$layers
bxp$plot_env
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "o"
)
bxp
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = NA
)
bxp
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
get_summary_stats(EG, type="mean_sd")
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
get_summary_stats(EG, type="mean_sd") %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -2.5, +2.5))
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -2.5, +2.5))
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -2.5, +2.5))
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG))
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -2.5, +2.5))
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -2.5, +2.5))
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos <- orinaFlavDupl
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -3.5, +3.5))
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -1.5, +1.5))
datos <- orinaFlavDupl
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -1.5, +1.5))
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
ggqqplot(datos, "EG", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos
rlang::last_error()
datos
datos[,-6]
res.aov <- anova_test(
data = datos[,-6], dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos <- ungroup(datos)
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
all(is.na(datos$numVol))
all(is.na(datos$Tiempo))
all(is.na(datos$Sexo))
all(is.na(datos$Endulzante))
anova_pareado_EG <- aov(formula = EG ~ Sexo * Endulzante * Tiempo +
Error(numVol/Tiempo),
data = orinaFlavDupl)
summary(anova_pareado_EG)
all(is.na(datos$EG))
lm(EG~numVol+Sexo:Endulzante, data= datos)
lm(EG~numVol+Tiempo:Endulzante, data= datos)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
datos <- orinaFlavFactors
datos %>% sample_n_by(EG, Peso, size = 1)
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -1.5, +1.5))
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
ggqqplot(datos, "EG", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
datos <- ungr(datos)
datos <- ungroup(datos)
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
View(bxp)
lm(EG~numVol+Tiempo:Endulzante:Sex, data= datos)
lm(EG~numVol+Tiempo:Endulzante:Sexo, data= datos)
datos <- datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
mutate(zscore = scale(EG)) %>%
filter(between(zscore, -1, +1))
bxp <- ggboxplot(
datos, x = "Endulzante", y = "EG",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, EG)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
datos <- ungroup(datos)
res.aov <- anova_test(
data = datos, dv = EG, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
lm(EG~numVol+Tiempo:Endulzante:Sexo, data= datos)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(EG)
ggplot(data = orinaFlavFactors, aes(x = EG)) +
geom_histogram(aes(y = ..density.., fill = ..count..)) +
scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C") +
stat_function(fun = dnorm, colour = "firebrick",
args = list(mean = mean(orinaFlavFactors$EG),
sd = sd(orinaFlavFactors$EG))) +
ggtitle("Histograma con curva normal teórica") +
theme_bw()
ggplot(data = orinaFlavFactors, aes(x = Peso)) +
geom_histogram(aes(y = ..density.., fill = ..count..)) +
scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C") +
stat_function(fun = dnorm, colour = "firebrick",
args = list(mean = mean(orinaFlavFactors$Peso),
sd = sd(orinaFlavFactors$Peso))) +
ggtitle("Histograma con curva normal teórica") +
theme_bw()
bxp <- ggboxplot(
datos, x = "Endulzante", y = "Peso",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos <- orinaFlavFactors
bxp <- ggboxplot(
datos, x = "Endulzante", y = "Peso",
color = "Tiempo", pallette = "jco",
facet.by = "Sexo", short.panel.labs = FALSE,
outlier.shape = "p"
)
bxp
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, Peso)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(EG)
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, Peso)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(Peso)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(Peso)
ggqqplot(datos, "EG", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
ggqqplot(datos, "Peso", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
res.aov <- anova_test(
data = datos, dv = Peso, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
lm(Peso~numVol+Tiempo:Endulzante:Sexo, data= datos)
devtools::install_github("kassambara/rstatix")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
install.packages("devtools")
gc()
install.packages("devtools")
install.packages("devtools")
source("~/Estudio/1stStepsPhD/article1.R", encoding = 'UTF-8')
install.packages("devtools")
install.packages("devtools")
datos <- orinaFlavFactors
res.aov <- anova_test(
data = datos, dv = Peso, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
library(tidyverse)
library(rstatix)
library(scales)
library(ggpubr)
library(factoextra)
library(GGally)
library(plotly)
library(FactoMineR)
library(cluster)
library(mclust)
library(reshape2)
library(gridExtra)
res.aov <- anova_test(
data = datos, dv = Peso, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)
datos %>%
group_by(Endulzante, Sexo, Tiempo) %>%
shapiro_test(Peso)
ggqqplot(datos, "Peso", ggtheme = theme_bw()) +
facet_grid(Endulzante + Sexo ~Tiempo, labeller="label_both")
datos %>%
select(Endulzante, Sexo, Tiempo, numVol, Peso)%>%
group_by(Endulzante, Sexo, Tiempo) %>%
identify_outliers(Peso)
res.aov <- anova_test(
data = datos, dv = Peso, wid= numVol,
within = c(Endulzante, Sexo, Tiempo)
)

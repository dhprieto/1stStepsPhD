for (i in colnames(tabla)[-1]){
if (is.numeric(tabla[,i]) && !(i %in% varsRemoved)){
message(paste("Variable analizada: ", i))
aov_test(tabla,i)
}
}
}
anovaTests <- function(tabla, varsRemoved) {
aov_loop(tabla, varsRemoved)
pairwiseTTest(tabla, varsRemoved)
}
boxplotBias <- function(vars, table1.0, factore, removeOutliers = F, titlePLot ){
# reading table
table1.1 <- table1.0 %>% select (all_of(vars), Time, Sex, Sweetener, -c(numVol, grouping))
if (removeOutliers){
for (i in colnames(table1.1)) {
if (is.numeric(table1.1[,i])){
table1.1 <- table1.1[!table1.1[, i] %in% boxplot.stats(table1.1[,i])$out,]
}
}
# return(table1.1)
}
# long table format
table1.2 <- melt(table1.1, id = c("Time", "Sex", "Sweetener"))
# plot factors
bxp <- function(longTable, factore){
if (factore == "Time") {
ggplot(longTable, aes(factor(variable,
level = unique(longTable$variable)),as.numeric(value),
fill=factor(longTable[,factore],
levels = c("Initial", "Final")))) +
geom_boxplot()+
ggtitle(titlePLot)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
labs(y = "standarized value", x = "Bio", fill = "Time")
}
else if (factore == "Sex") {
ggplot(longTable, aes(factor(variable,
level = unique(longTable$variable)),as.numeric(value),
fill=factor(longTable[,factore]))) +
geom_boxplot()+
ggtitle(paste(titlePLot))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
labs(y = "standarized value", x = "variables", fill = "Sex")+
scale_fill_brewer(palette = "Reds")+
facet_wrap(~factor(Time, levels = c("Initial", "Final")))
}
else if (factore == "Sweetener"){
ggplot(longTable, aes(factor(variable,
level = unique(longTable$variable)),as.numeric(value),
fill=factor(longTable[,factore])), colour = "Sweetener") +
geom_boxplot()+
ggtitle(titlePLot)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
labs(y = "standarized value", x = "variables", fill = "Sweetener")+
facet_wrap(~factor(Time, levels = c("Initial", "Final")))
}
}
bxp(table1.2, factore)
}
pairwiseTTest <- function(tabla, varsRemoved){
for (i in colnames(tabla)){
if (is.numeric(tabla[,i]) & !(i %in% varsRemoved)){
message(paste("Analized variable: ", i))
message(paste("Time comparisons ", i))
print(pairwise_t_test(data = tabla , formula = as.formula(paste(sym(i),"~ Time")),
paired = T, p.adjust.method = "bonferroni")
%>% dplyr::select(-df, -statistic))
tablaGr <- group_by(tabla, Sweetener, Sex)
message(paste("Time-Sweetener-Sex comparisons", i))
print(pairwise_t_test(data = tablaGr, formula = as.formula(paste(sym(i),"~ Time")),
paired = T, p.adjust.method = "bonferroni") %>% dplyr::select(-df, -statistic))
tablaGr <- group_by(tabla, Sweetener)
message(paste("Time-Sweetener comparisons", i))
print(pairwise_t_test(data = tablaGr , formula = as.formula(paste(sym(i),"~ Time")),
paired = T, p.adjust.method = "bonferroni") %>% dplyr::select(-df, -statistic))
tablaGr <- group_by(tabla, Sex)
message(paste("Time-Sex comparisons", i))
print(pairwise_t_test(data = tablaGr , formula = as.formula(paste(sym(i),"~ Time")),
paired = T, p.adjust.method = "bonferroni") %>% dplyr::select(-df, -statistic))
}
}
}
main1prepoc <- function(pathToTable, pathtoRealTable){
tabla1.0 <- readingFillingGrouping(pathToTable)
tabla1.1 <- normalizingNumeric(tabla1.0)
tabla1.2 <- factoringImputating(tabla1.1)
#tabla1.2_stats <- estadisticosDescriptivos(urAnt1.2)
tabla1.3 <- timingCleanFeatures(tabla1.2, pathtoRealTable)
return (tabla1.3)
}
p4 <- ggplot(longtableFn, aes(factor(variable, level = unique(longtableFn$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
coord_cartesian(ylim = quantile(longtableFn$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexFn, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.5, ymax=0.57)+
annotation_custom(grob = tableGrob(tableSweetenerFn, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.4, ymax=0.47)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("B. Anthocyanins in urine at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
ggarrange(p1,p2)
borutaAP_I <- Boruta(Sex~ ., data = urinePlasmImp %>%
filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time, DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)), doTrace = 3, maxRuns = 500)
borutaAP_I <- Boruta(Sex~ ., data = plasmAntImp %>%
filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time, DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)), doTrace = 3, maxRuns = 500)
# BORUTA RESULTS:
getSelectedAttributes(borutaI)
# BORUTA RESULTS:
getSelectedAttributes(borutaAP_I)
tableAP_I <-  urineAntImp %>%
filter(Time == "Initial") %>%
select(getSelectedAttributes(borutaAP_I))
comparisonTI <- clValid(
obj        = tableAP_I,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
summary(comparisonTI)
clustersAP_I <- cluster::pam(tableAP_I, k = 6, metric = "manhattan")
pcaAP_I <- prcomp(tableAP_I)
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$clustering, addEllipses = T,
title = "A. Anthocyanins in Plasm at Initial Time")
p1
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$clustering, addEllipses = T, fill.var = "black"
title = "A. Anthocyanins in Plasm at Initial Time")
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$clustering, addEllipses = T, fill.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
p1
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$clustering, addEllipses = T, col.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
title = "A. Anthocyanins in Plasm at Initial Time")
p1
borutaAP_F <- Boruta(Sex:Sweetener~ ., data = plasmAntImp %>%
filter(Time == "Final") %>%
select(-c(grouping, numVol, Time, DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)), doTrace = 3, maxRuns = 500)
# BORUTA RESULTS:
getSelectedAttributes(borutaAP_F)
tableAP_F <-  urineAntImp %>%
filter(Time == "Final") %>%
select(getSelectedAttributes(borutaAP_F))
comparisonAP_F <- clValid(
obj        = tableAP_F,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
summary(comparisonAP_F)
clustersAP_F <-cluster::pam(x = tableAP_F, k = 6, metric = "manhattan")
pcaAP_F <- prcomp(tableAP_F)
p2 <- fviz_pca_biplot(pcaAP_F, habillage = clustersAP_F$clustering, addEllipses = T,col.var = "black",
title = "B. Anthocyanins in Plasm at Final Time")
p2
tablaClustersAP_I <-  plasmAntImp %>% filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time,DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)) %>%
add_column(clusters = clustersAP_I$clustering)
clustersAP_I$clustering
length(clustersAP_I$clustering)
plasmAntImp %>% filter(Time == "Initial")
length(plasmAntImp %>% filter(Time == "Initial"))
plasmAntImp %>% filter(Time == "Initial")
tableAP_I <-  plasmAntImp %>%
filter(Time == "Initial") %>%
select(getSelectedAttributes(borutaAP_I))
comparisonAP_I <- clValid(
obj        = tableAP_I,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
summary(comparisonAP_I)
clustersAP_I <- kmeans(tableAP_I, centers = 6)
clustersAP_I <- kmeans(tableAP_I, centers = 6)
pcaAP_I <- prcomp(tableAP_I)
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$cluster, addEllipses = T, col.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
P1
P1
p1
clustersAP_I <- kmeans(tableAP_I[-81,], centers = 6)
pcaAP_I <- prcomp(tableAP_I[-81,])
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$cluster, addEllipses = T, col.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
p1
tablaClustersAP_I <-  plasmAntImp %>% filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time,DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)) %>%
add_column(clusters = clustersAP_I$cluster)
clustersAP_I <- kmeans(tableAP_I, centers = 6)
pcaAP_I <- prcomp(tableAP_I)
p1 <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$cluster, addEllipses = T, col.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
tablaClustersAP_I <-  plasmAntImp %>% filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time,DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)) %>%
add_column(clusters = clustersAP_I$cluster)
tableSexAP_I <- table(tablaClustersAP_I$Sex, tablaClustersAP_I$clusters)#tabla_clusters %>% count(Sexo, clusters)
tablaClustersAP_I <- tablaClustersAP_I %>% select(-c(Sweetener, Sex))
longtableAP_I <- melt(tablaClustersAP_I, id = c("clusters"))
p3 <- ggplot(longtableAP_I, aes(factor(variable, level = unique(longtableAP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
coord_cartesian(ylim = quantile(longtableAP_I$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin=16,xmax=19, ymin=0.4, ymax=0.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("A. Anthocyanins in Plasm at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p3
p1_AP <- fviz_pca_biplot(pcaAP_I, habillage = clustersAP_I$cluster, addEllipses = T, col.var = "black",
title = "A. Anthocyanins in Plasm at Initial Time")
p2_AP <- fviz_pca_biplot(pcaAP_F, habillage = clustersAP_F$clustering, addEllipses = T,col.var = "black",
title = "B. Anthocyanins in Plasm at Final Time")
p3_AP <- ggplot(longtableAP_I, aes(factor(variable, level = unique(longtableAP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
coord_cartesian(ylim = quantile(longtableAP_I$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin=16,xmax=19, ymin=0.4, ymax=0.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("A. Anthocyanins in Plasm at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p3_AP
p3_AP <- ggplot(longtableAP_I, aes(factor(variable, level = unique(longtableAP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableAP_I$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin=16,xmax=19, ymin=0.4, ymax=0.5)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("A. Anthocyanins in Plasm at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p3_AP
p3_AP <- ggplot(longtableAP_I, aes(factor(variable, level = unique(longtableAP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableAP_I$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin=14,xmax=17, ymin=0.75, ymax=1)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("A. Anthocyanins in Plasm at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p3_AP
tablaClustersAP_F <-  plasmAntImp %>% filter(Time == "Final")%>%
select(-c(grouping, numVol, Time, DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)) %>%
add_column(clusters = clustersAP_F$clustering)
tableAP_F <-  plasmAntImp %>%
filter(Time == "Final") %>%
select(getSelectedAttributes(borutaAP_F))
comparisonAP_F <- clValid(
obj        = tableAP_F,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
summary(comparisonAP_F)
clustersAP_F <-cluster::pam(x = tableAP_F, k = 6, metric = "manhattan")
pcaAP_F <- prcomp(tableAP_F)
p2_AP <- fviz_pca_biplot(pcaAP_F, habillage = clustersAP_F$clustering, addEllipses = T,col.var = "black",
title = "B. Anthocyanins in Plasm at Final Time")
p2_AP
tablaClustersAP_F <-  plasmAntImp %>% filter(Time == "Final") %>%
select(-c(grouping, numVol, Time, DHPAA.di.Sulfate, TFA.Gluc, VA, VA.Sulfate)) %>%
add_column(clusters = clustersAP_F$clustering)
tableSexAP_F <- table(tablaClustersAP_F$Sex, tablaClustersAP_F$clusters) #tabla_clusters %>% count(Sexo, clusters)
tableSweetenerAP_F <- table(tablaClustersAP_F$Sweetener, tablaClustersAP_F$clusters) #tabla_clusters %>% count(Endulzante, clusters)
tablaClustersAP_F <- tablaClustersAP_F %>% select(-c(Sweetener, Sex))
longtableFn <- melt(tablaClustersAP_F, id = c("clusters"))
p4 <- ggplot(longtableFn, aes(factor(variable, level = unique(longtableFn$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableFn$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.5, ymax=0.57)+
annotation_custom(grob = tableGrob(tableSweetenerAP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.4, ymax=0.47)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("B. Anthocyanins in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p4_AP <- ggplot(longtableFn, aes(factor(variable, level = unique(longtableFn$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableFn$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.5, ymax=0.57)+
annotation_custom(grob = tableGrob(tableSweetenerAP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 16,xmax=19, ymin=0.4, ymax=0.47)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("B. Anthocyanins in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p4_AP
p4_AP <- ggplot(longtableFn, aes(factor(variable, level = unique(longtableFn$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableFn$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 13,xmax=16, ymin=0.85, ymax=1.05)+
annotation_custom(grob = tableGrob(tableSweetenerAP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 13,xmax=16, ymin=0.65, ymax=0.85)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("B. Anthocyanins in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p4_AP
p4_AP <- ggplot(longtableFn, aes(factor(variable, level = unique(longtableFn$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
# coord_cartesian(ylim = quantile(longtableFn$value, c(0, 0.97)))+
annotation_custom(grob = tableGrob(tableSexAP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 13,xmax=16, ymin=0.95, ymax=1.15)+
annotation_custom(grob = tableGrob(tableSweetenerAP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 13,xmax=16, ymin=0.75, ymax=0.95)+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))+
ggtitle("B. Anthocyanins in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Anthocyanins", fill = "Cluster")
p4_AP
ggarrange(p1_AP,p2_AP)
ggarrange(p1_AP,p2_AP)
ggarrange(p3_AP,p4_AP)
View(plasmFlavImp)
set.seed(123)
set.seed(123)
borutaFP_I <- Boruta(Sex~ ., data = plasmFlavImp %>%
filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time,Total.E)), doTrace = 2, maxRuns = 500)
tableIn <-  plasmFlavImp %>%
filter(Time == "Initial")  %>%
select(getSelectedAttributes(borutaFP_I))
getSelectedAttributes(borutaFP_I)
borutaFP_I <- Boruta(Sex:Sweetener~ ., data = plasmFlavImp %>%
filter(Time == "Initial") %>%
select(-c(grouping, numVol, Time,Total.E)), doTrace = 2, maxRuns = 500)
getSelectedAttributes(borutaFP_I)
tableFP_I <-  plasmFlavImp %>%
filter(Time == "Initial")  %>%
select(c(E, ES, HE.G, NG))
comparisonFP_I <- clValid(
obj        = tableFP_I,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
summary(comparisonFP_I)
clustersFP_I <- Mclust(tableFP_I, G= 2)
pcaFP_I <- prcomp(tableFP_I)
pcaFP_I <- prcomp(tableFP_I)
p1 <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1FP_I <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1_FP <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1_FP
clustersFP_I <- Mclust(tableFP_I)
pcaFP_I <- prcomp(tableFP_I)
p1_FP <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1_FP
clustersFP_I <- Mclust(tableFP_I, G= 2)
pcaFP_I <- prcomp(tableFP_I)
p1_FP <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1_FP
borutaFP_F <- Boruta(Sex~ ., data = plasmFlavImp %>%
filter(Time == "Final") %>%
select(-c(grouping, numVol, Time,Total.E)), doTrace = 2, maxRuns = 500)
getSelectedAttributes(borutaFP_F)
tableFP_I <-  plasmFlavImp %>%
filter(Time == "Final")  %>%
select(c(E, ES, HE.G, NG))
tableFP_F <-  plasmFlavImp %>%
filter(Time == "Final")  %>%
select(c(E, ES, HE.G, NG))
comparisonFP_F <- clValid(
obj        = tableFP_F,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
comparisonFP_F <- clValid(
obj        = tableFP_F,
nClust     = 2:6,
clMethods  = c( "hierarchical", "kmeans", "diana", "fanny", "som", "model", "sota", "pam", "clara","agnes"),
validation = c("stability", "internal")
)
tableFP_I <-  plasmFlavImp %>%
filter(Time == "Initial")  %>%
select(c(E, ES, HE.G, NG))
summary(comparisonFP_F)
distancesFP_F <- dist(tableFP_F, method = "manhattan")
dianaFP_F <- diana(distancesFP_F, diss = T, metric = "manhattan")
clustersFP_F <- cutree(dianaFP_F, k = 4)
pcaFP_F <- prcomp(tableFP_F)
clustersFP_F
p2_FP <- fviz_pca_biplot(pcaFP_F, habillage = clustersFP_F, addEllipses = T,col.var = "black",
title = "B. Flavanones in Plasm at Final Time")
p2_FP
distancesFP_F <- dist(tableFP_F[-c(55, 105),], method = "manhattan")
dianaFP_F <- diana(distancesFP_F, diss = T, metric = "manhattan")
clustersFP_F <- cutree(dianaFP_F, k = 4)
pcaFP_F <- prcomp(tableFP_F[-c(55, 105),])
p2_FP <- fviz_pca_biplot(pcaFP_F, habillage = clustersFP_F, addEllipses = T,col.var = "black",
title = "B. Flavanones in Plasm at Final Time")
p2_FP
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersIn$clustering)
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_I$clustering)
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_I$clustering)
tableSexFP_I <- table(tablaClustersFP_I$Sex, tablaClustersFP_I$clusters)#tabla_clusters %>% count(Sexo, clusters)
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_I$classification)
tableSexFP_I <- table(tablaClustersFP_I$Sex, tablaClustersFP_I$clusters)#tabla_clusters %>% count(Sexo, clusters)
tablaClustersFP_I <- tablaClustersFP_I %>% select(-c(Sweetener, Sex))
longtableFP_I <- melt(tablaClustersFP_I, id = c("clusters"))
p3_FP <- ggplot(longtableFP_I, aes(factor(variable, level = unique(longtableFP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 9,xmax=13, ymin=0.75, ymax=1.25)+
ggtitle("A. Flavanones in urine at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
p3_FP
p3_FP <- ggplot(longtableFP_I, aes(factor(variable, level = unique(longtableFP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1.25)+
ggtitle("A. Flavanones in urine at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
p3_FP
clustersFP_I <- Mclust(tableFP_I, G= 4)
pcaFP_I <- prcomp(tableFP_I)
p1_FP <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
p1_FP
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_I$classification)
tablaClustersFP_I <- tablaClustersFP_I %>% select(-c(Sweetener, Sex))
longtableFP_I <- melt(tablaClustersFP_I, id = c("clusters"))
p3_FP
clustersFP_I <- Mclust(tableFP_I, G= 4)
pcaFP_I <- prcomp(tableFP_I)
p1_FP <- fviz_pca_biplot(pcaFP_I, habillage = clustersFP_I$classification, addEllipses = T, col.var = "black",
title = "A. Flavanones in Plasm at Initial Time")
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_I$classification)
tableSexFP_I <- table(tablaClustersFP_I$Sex, tablaClustersFP_I$clusters)#tabla_clusters %>% count(Sexo, clusters)
tablaClustersFP_I <- tablaClustersFP_I %>% select(-c(Sweetener, Sex))
longtableFP_I <- melt(tablaClustersFP_I, id = c("clusters"))
p3_FP <- ggplot(longtableFP_I, aes(factor(variable, level = unique(longtableFP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1.25)+
ggtitle("A. Flavanones in urine at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
p3_FP
p3_FP <- ggplot(longtableFP_I, aes(factor(variable, level = unique(longtableFP_I$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_I, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1.25)+
ggtitle("A. Flavanones in Plasm at Initial Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
tablaClustersFP_F <-  plasmFlavImp %>% filter(Time == "Final")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_F)
tablaClustersFP_F <-  plasmFlavImp[-c(55, 105),] %>% filter(Time == "Final")%>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_F)
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")%>% filter(!row_number() %in% c(55,105))
tableSexFP_I <- table(tablaClustersFP_I$Sex, tablaClustersFP_I$clusters)#tabla_clusters %>% count(Sexo, clusters)
tablaClustersFP_I <-  plasmFlavImp %>% filter(Time == "Initial")
tablaClustersFP_F <-  plasmFlavImp %>% filter(Time == "Final") %>% filter(!row_number() %in% c(55,105))
tableSexFP_F <- table(tablaClustersFP_F$Sex, tablaClustersFP_F$clusters) #tabla_clusters %>% count(Sexo, clusters)
tablaClustersFP_F$clusters
clustersFP_F
tablaClustersFP_F <-  plasmFlavImp %>% filter(Time == "Final") %>% filter(!row_number() %in% c(55,105))
tablaClustersFP_F$clusters
tablaClustersFP_F <-  plasmFlavImp %>% filter(Time == "Final") %>% filter(!row_number() %in% c(55,105)) %>%
select(-c(grouping, numVol, Time, Total.E)) %>%
add_column(clusters = clustersFP_F)
tableSexFP_F <- table(tablaClustersFP_F$Sex, tablaClustersFP_F$clusters) #tabla_clusters %>% count(Sexo, clusters)
tableSweetenerFP_F <- table(tablaClustersFP_F$Sweetener, tablaClustersFP_F$clusters) #tabla_clusters %>% count(Endulzante, clusters)
tablaClustersFP_F <- tablaClustersFP_F %>% select(-c(Sweetener, Sex))
longtableFP_F <- melt(tablaClustersFP_F, id = c("clusters"))
p4_FP <- ggplot(longtableFP_F, aes(factor(variable, level = unique(longtableFP_F$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1.25)+
annotation_custom(grob = tableGrob(tableSweetenerFP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.70, ymax=0.80)+
ggtitle("B. Flavanones in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
p4_FP
p
p4_FP <- ggplot(longtableFP_F, aes(factor(variable, level = unique(longtableFP_F$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableSweetenerFP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.5, ymax=0.75)+
ggtitle("B. Flavanones in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
p4_FP
ggarrange(p1_FP,p2_FP)
ggarrange(p3_FP,p4_FP)
p4_FP <- ggplot(longtableFP_F, aes(factor(variable, level = unique(longtableFP_F$variable)),as.numeric(value),
fill=factor(clusters)))+ geom_boxplot()+
annotation_custom(grob = tableGrob(tableSexFP_F, rows = c("M", "W"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.75, ymax=1)+
annotation_custom(grob = tableGrob(tableSweetenerFP_F, rows=c("SA", "ST","SU"), theme = ttheme_default(base_size = 8)),
xmin= 3,xmax=6, ymin=0.57, ymax=0.75)+
ggtitle("B. Flavanones in Plasm at Final Time")+
labs(y = "Standarized Value", x = "Bioactive Flavanones", fill = "Cluster")
ggarrange(p3_FP,p4_FP)
